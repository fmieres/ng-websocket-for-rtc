!function(){"use strict";angular.module("ng-websocket-for-rtc",["ngWebSocket"]),function(){function e(){function e(e){function t(e){g.$server.send(JSON.stringify({data:e,type:"webrtc"}))}function o(e){g.$server.send(JSON.stringify({data:e,type:"server"}))}function c(){}function i(e,n){return g.$register.register(e,n)}function s(e,n){return g.$register_once.register(e,n)}function a(e){return g.$register.unregister(e)}function u(e){var n=JSON.parse(e.data);return n.keyword?g.$register.hasCallback(n.keyword)||g.$register_once.hasCallback(n.keyword)?f(n.keyword,[n.data,n.sender,e]):c(n,e):c(e)}function f(e,n){g.$register.callbacks(e).forEach(function(e){e.apply(void 0,n)}),g.$register_once.callbacks(e).forEach(function(e){e.apply(void 0,n)})}function l(e,n,r){return g.$register.hasCallback(e)||g.$register_once.hasCallback(data.keyword)?f(e,[n,r]):c(n,r)}function d(){return g.$server=$websocket(e),g.$server.onMessage(u),g.$server.onOpen(function(){g.isReady=!0,l("system_on_open",event)}),g.$server.onClose(function(e){var n=g.isReady;g.isReady=!1,e.code==v&&setTimeout(function(){g.connect()},1e3),l("system_on_close",e,{lastReadyState:n})}),g.$server.onError(function(){g.isReady=!1}),g}var g=this,v=1006;g.isReady=!1,g.url=e,g.$register=new n,g.$register_once=new r,g.on=i,g.on_once=s,g.send=t,g.connect=d,g.unregister=a,g.serverSend=o}function n(){function e(e,n){var r=c(),t=s[e];if(t)t[r]=n;else{var o={};o[r]=n,s[e]=o}return i[r]=e,r}function n(e){return!!s[e]}function r(e){return Object.values(s[e]||{})}function t(e){var n=i[e];delete s[n][e]}var o=this,i={},s={};o.register=e,o.callbacks=r,o.unregister=t,o.hasCallback=n}function r(){function e(e,n){c[e]=n}function n(e){return o.hasCallback(e)?[c[e]]:[]}function r(e){delete c[e]}function t(e){return!!c[e]}var o=this,c={};o.register=e,o.callbacks=n,o.unregister=r,o.hasCallback=t}var t=this,o="",c=function(){return Math.random().toString()};t.webSocketUrl=function(e){o=e},t.generateIdStrategy=function(e){c=e},t.$get=["$websocket",function(n){var r=new e(n,o);return r.connect(),r}]}angular.module("ng-websocket-for-rtc").provider("WebSocket",e)}()}();