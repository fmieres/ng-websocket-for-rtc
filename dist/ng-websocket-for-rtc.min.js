!function(){"use strict";angular.module("ng-websocket-for-rtc",["ngWebSocket"]),function(){function e(){function e(e,t){function o(e){v.$server.send(JSON.stringify({data:e,type:"webrtc"}))}function c(e){v.$server.send(JSON.stringify({data:e,type:"server"}))}function i(){}function a(e,n){return v.$register.register(e,n)}function s(e,n){return v.$register_once.register(e,n)}function u(e){return v.$register.unregister(e)}function f(e){var n=JSON.parse(e.data);return n.keyword?v.$register.hasCallback(n.keyword)||v.$register_once.hasCallback(n.keyword)?l(n.keyword,[n.data,n.sender,e]):i(n,e):i(e)}function l(e,n){v.$register.callbacks(e).forEach(function(e){e.apply(void 0,n)}),v.$register_once.callbacks(e).forEach(function(e){e.apply(void 0,n)})}function d(e,n,r){return v.$register.hasCallback(e)||v.$register_once.hasCallback(data.keyword)?l(e,[n,r]):i(n,r)}function g(){return v.$server=e(t),v.$server.onMessage(f),v.$server.onOpen(function(){v.isReady=!0,d("system_on_open",event)}),v.$server.onClose(function(e){var n=v.isReady;v.isReady=!1,e.code==k&&setTimeout(function(){v.connect()},1e3),d("system_on_close",e,{lastReadyState:n})}),v.$server.onError(function(){v.isReady=!1}),v}var v=this,k=1006;v.isReady=!1,v.url=t,v.$register=new n,v.$register_once=new r,v.on=a,v.on_once=s,v.send=o,v.connect=g,v.unregister=u,v.serverSend=c}function n(){function e(e,n){var r=c(),t=a[e];if(t)t[r]=n;else{var o={};o[r]=n,a[e]=o}return i[r]=e,r}function n(e){return!!a[e]}function r(e){return Object.values(a[e]||{})}function t(e){var n=i[e];delete a[n][e]}var o=this,i={},a={};o.register=e,o.callbacks=r,o.unregister=t,o.hasCallback=n}function r(){function e(e,n){c[e]=n}function n(e){return o.hasCallback(e)?[c[e]]:[]}function r(e){delete c[e]}function t(e){return!!c[e]}var o=this,c={};o.register=e,o.callbacks=n,o.unregister=r,o.hasCallback=t}var t=this,o="",c=function(){return Math.random().toString()};t.webSocketUrl=function(e){o=e},t.generateIdStrategy=function(e){c=e},t.$get=["$websocket",function(n){var r=new e(n,o);return r.connect(),r}]}angular.module("ng-websocket-for-rtc").provider("WebSocket",e)}()}();